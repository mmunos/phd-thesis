In this chapter, we introduce annotated grammars, an extension of context-free grammars which allows annotations on terminals. We study the enumeration problem for annotated grammars: fixing a grammar, and given a string as input, enumerate all annotations of the string that form a word derivable from the grammar. 

The first result in this chapter is an algorithm for unambiguous annotated grammars, which preprocesses the input string in cubic time and enumerates all annotations with output-linear delay. 

We then study how we can reduce the preprocessing time while keeping the same delay bound, by making additional assumptions on the grammar. Specifically, we present a class of grammars which only have one derivation shape for all outputs, for which we can enumerate with quadratic time preprocessing. 

We also give classes that generalize regular spanners for which linear time preprocessing is enough.

%

\paragraph{Comparison to previous chapter}
In this chapter, we re-use the
enumeration data structure of Chapter~\ref{ch1}, and we consider a transducer model in
Section~\ref{gram:sec:linear} that recaptures some of the already presented results. 
However, in our
problem, we work with pushdown automata without a {\em visibility} guarantee. This poses new technical
challenges: the underlying tree structure (i.e., the parse tree) is not known in
advance and generally not unique.

\paragraph{Outline of the paper}
In Section~\ref{gram:sec:models} we give some basic definitions of the concepts we will use througout the paper. In Section~\ref{gram:sec:cubic}, we describe our results for unambiguous grammars. In Section~\ref{gram:sec:quadratic}, we present a relaxation of unambiguous grammars that we call rigid grammars, and some results for this class. In Section~\ref{gram:sec:linear}, we describe our results for pushdown annotators. In Section~\ref{gram:sec:spanners}, we detail how to use our results in the context of document spanners. We close our chapter in Section~\ref{gram:sec:relwork} by discussing related work.

