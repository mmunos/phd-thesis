First, we present a query model named Visibly Pushdown Annotators (VPAnn), which is a computational model that extends visibly pushdown automata with outputs and has the same expressive power as Monadic Second Order over nested documents. We study the task of receiving the input data in a streaming document, and we show an algorithm which enumerates the outputs with output-linear delay after a preprocessing phase which takes data-independent time after receiving each character in the input data.

Furthermore, we show that this algorithm is worst-case optimal in terms of update-time per symbol and memory usage.